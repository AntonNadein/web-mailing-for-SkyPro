{% extends 'mailing/base.html' %}

{% block content %}
<h2 class="mt-5 text-center">Статистика</h2>
<h3 class="mt-1 text-start">Всего рассылок: <span class="mt-1 text-secondary">{{ count_newsletter }}</span></h3>
<h3 class="mt-1 text-start">Рассылок запущено: <span class="mt-1 text-secondary">{{ count_status }}</span></h3>
<h3 class="mt-1 text-start">Уникальных пользователей: <span class="mt-1 text-secondary">{{ unique_users }}</span></h3>

<h4 class="mt-5 text-center">Запущенные рассылки</h4>
<table class="table table-striped">
    <thead>
    <tr>
        <th scope="col">#</th>
        <th scope="col">Название рассылки</th>
        <th scope="col">Текст рассылки</th>
        <th scope="col">Статус</th>
        <th scope="col">Начало рассылки</th>
        <th scope="col">Окончание рассылки</th>
        <th scope="col">Детали</th>
    </tr>
    </thead>
    <tbody>
    {% for news in newsletter %}
    {% if news.status == 'started' %}
    <tr>
        <th scope="row">{{ news.id }}</th>
        <td>{{ news.name }}</td>
        <td>{{ news.text }}</td>
        <td>{{ news.human_readable_status }}</td>
        <td>{{ news.first_dispatch }}</td>
        <td>{{ news.end_dispatch }}</td>
        <td><a class="link" href="{% url 'mailing:newsletter_detail' news.pk %}">Подробнее</a></td>
    </tr>
    {% endif %}
    {% endfor %}
    </tbody>
</table>
<hr class="featurette-divider">
{% endblock %}